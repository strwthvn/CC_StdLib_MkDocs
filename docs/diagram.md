# Архитектура библиотеки CC_StdLib

## Обзор архитектуры

Библиотека CC_StdLib построена по принципам объектно-ориентированного программирования и включает в себя следующие основные компоненты:

- **Обработка сигналов**: дискретные и аналоговые сигналы с различными типами обработки
- **Механизмы**: иерархия классов для управления исполнительными устройствами  
- **Управление**: блоки для реализации логики управления
- **Коммуникация**: утилиты для обмена данными и преобразования форматов
- **Диагностика**: блоки для мониторинга и контроля параметров

## Диаграммы классов по категориям

Для детального изучения архитектуры библиотеки выберите интересующую категорию:

### [Обработка сигналов](diagrams/signals-diagram.md){:target="_blank"}
Дискретные и аналоговые сигналы, детекция изменений, диагностика

### [Механизмы и управление](diagrams/mechanisms-diagram.md){:target="_blank"}  
Иерархия механизмов, интерфейсы управления, обратная связь

### [Коммуникация](diagrams/communication-diagram.md){:target="_blank"}
Преобразование данных, работа с протоколами связи

### [Полная диаграмма](full-diagram.md){:target="_blank"}
Общий обзор всех компонентов библиотеки

*Диаграммы откроются в новых окнах для удобного изучения деталей.*

## Краткая схема основных взаимосвязей

```mermaid
---
config:
  theme: dark
  themeVariables:
    background: '#1e1e1e'
    primaryColor: '#3f3f46'
    primaryTextColor: '#e4e4e7'
    primaryBorderColor: '#71717a'
    lineColor: '#a1a1aa'
    secondaryColor: '#27272a'
    tertiaryColor: '#18181b'
    classText: '#e4e4e7'
---
graph TD
    A[FB_BasicSignal] --> B[FB_SignalWithTrigger]
    A --> C[FB_SignalWithFeedback]
    C --> D[FB_SignalWithFeedbackTimer]
    
    E[FB_BasicAnalogSignal] --> F[FB_AnalogSignal4_20mA]
    E --> G[FB_UniversalAnalogSignal]
    
    H[FB_AbstractMechanism] --> I[FB_Mechanism]
    I --> J[FB_MechanismWithFeedback]
    
    K[I_Control] -.-> I
    L[FB_BasicControl] --> K
    
    style A fill:#374151,stroke:#6b7280,color:#e5e7eb
    style E fill:#4c1d95,stroke:#7c3aed,color:#e5e7eb
    style H fill:#065f46,stroke:#10b981,color:#e5e7eb
    style K fill:#92400e,stroke:#f59e0b,color:#e5e7eb
```

## Описание основных компонентов

### Обработка дискретных сигналов
- **FB_BasicSignal**: Базовый класс для работы с булевыми сигналами
- **FB_SignalWithTrigger**: Детекция фронтов сигналов
- **FB_SignalWithFeedback**: Контроль обратной связи
- **FB_SignalWithFeedbackTimer**: Контроль обратной связи с таймаутом
- **FB_SignalWithRattling**: Фильтрация дребезга контактов

### Обработка аналоговых сигналов
- **FB_BasicAnalogSignal**: Абстрактный базовый класс для аналоговых сигналов
- **FB_AnalogSignal4_20mA**: Специализированный блок для токовой петли 4-20 мА
- **FB_UniversalAnalogSignal**: Универсальный блок для любых аналоговых сигналов

### Диагностика
- **FB_RangeDiagnostic_LH**: Контроль параметров с четырехуровневой системой аварий
- **FB_NumericChangeDetector**: Обнаружение изменений числовых значений

### Механизмы и управление
- **FB_AbstractMechanism**: Абстрактный базовый класс механизмов
- **FB_Mechanism**: Базовая реализация механизма
- **FB_MechanismWithFeedback**: Механизм с диагностикой обратной связи
- **FB_BasicControl**: Базовое управление с условиями
- **FB_FrequencyControl**: Управление частотными преобразователями

### Коммуникация
- **U_ByteToWord**, **U_RealToWord**: Объединения для преобразования типов данных
- **FC_SwapBytes...**: Функции для работы с порядком байтов в протоколах связи

### Интерфейсы и перечисления
- **I_Control**: Стандартный интерфейс управления
- **E_AlarmSetpoints**: Уровни аварий и предупреждений
- **E_StateFeedback**: Состояния обратной связи механизмов

## Принципы архитектуры

### Иерархия наследования
Библиотека построена на принципах объектно-ориентированного программирования:
- **Абстрактные базовые классы** определяют общий интерфейс и основную функциональность
- **Производные классы** расширяют базовую функциональность для специфических задач
- **Интерфейсы** обеспечивают единообразие управления различными типами устройств

### Композиция и агрегация
- Сложные блоки используют более простые как компоненты
- Например, `FB_SignalWithFeedback` использует `FB_SignalWithTrigger` для детекции фронтов

### Полиморфизм
- Единый интерфейс `I_Control` позволяет управлять различными механизмами одинаково
- Абстрактные методы обеспечивают специфичную реализацию в производных классах